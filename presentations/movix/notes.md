### Movix Billing Service

–Ø–Ω–¥–µ–∫—Å.–ü—Ä–∞–∫—Ç–∏–∫—É–º, 25 –ö–æ–≥–æ—Ä—Ç–∞, 7 –∫–æ–º–∞–Ω–¥–∞

<br>

##### –°–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã

-   –°—Ç–∞–Ω–∏—Å–ª–∞–≤ –ë–æ–≥–∞—Ü–∫–∏–π, team lead, [github](https://github.com/sbkubric)
-   –í–∏–∫—Ç–æ—Ä –ì–æ—Å—Ç—è–π–∫–∏–Ω, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, [github](https://github.com/Viktor-Gostyaikin)
-   –°–µ—Ä–≥–µ–π –ö–æ–ª—Ç—É–Ω–æ–≤, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, [github](https://github.com/dogbusiness)

note: –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

–ù–∞—à –¥–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç - billing.

–ù–∞—á–Ω—É —Å —Ç–æ–≥–æ, –∫–∞–∫ –º—ã –ø—Ä–∏—à–ª–∏ –∫ —Ç–æ–º—É —Å–µ—Ä–≤–∏—Å—É, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏–ª—Å—è.

h---

### –ö–∞–∫ –≤—Å—ë –Ω–∞—á–∏–Ω–∞–ª–æ—Å—å...

–ü–ª–∞–Ω –≤ –º–æ–µ–π –≥–æ–ª–æ–≤–µ:

![image](./content/start.png)

note: –ü–ª–∞–Ω –±—ã–ª —Ö–æ—Ä–æ—à: —á–∏—Ç–∞–µ–º –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á, –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º –∏ —Ä–∞—Å–∫–∏–¥—ã–≤–∞–µ–º —Ç–∞—Å–∫–∏, –∫–æ–¥–∏–º —Å–µ—Ä–≤–∏—Å, –≤—Å—ë –±—É–¥–µ—Ç –≤ —à–æ–∫–æ–ª–∞–¥–µ.

h---

### –•–æ—Ç–µ–ª–∫–∏ –±–∏–∑–Ω–µ—Å–∞

![buisiness-requirements](./content/business_requirements.png)

note: –†–µ–∞–ª—å–Ω–æ—Å—Ç—å –æ–∫–∞–∑–∞–ª–∞—Å—å –±–æ–ª–µ–µ —Å—É—Ä–æ–≤–æ–π.

h---

### –ê —á—Ç–æ –¥–µ–ª–∞—Ç—å?

![–ú–µ–º —Å –¢—Ä–∞–≤–æ–ª—Ç–æ–π](https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fmedia1.tenor.com%2Fimages%2Fc224be2073156574d456f8f3b86d927a%2Ftenor.gif%3Fitemid%3D14193582&f=1&nofb=1&ipt=e41c4371396a0e6909169de7a0817247d87712a7f3a2d709c66f9bc1d9e3ec0c&ipo=images)
note: –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –±—ã–ª–∏ –æ–±—â–∏–º–∏, –∏ –∏—Ö –±—ã–ª–æ –º–∞–ª–æ.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å? –Ø —Ä–µ—à–∏–ª —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ç–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

[comment]: <> (–°–ª–∞–π–¥ –¥–ª—è —Ñ—Ä–∞–∑—ã "–î–ª—è –Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏–º –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ)
h---

### C—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:

-   –ü—Ä–æ–≤–æ–¥–∏—Ç—å –ø–ª–∞—Ç–µ–∂–∏
-   –î–µ–ª–∞—Ç—å —Ä–µ—Ñ–∞–Ω–¥—ã
-   –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ —Å –ø–æ–º–æ—â—å—é –∞–¥–º–∏–Ω–∫–∏
-   –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ –±–µ–∑ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

note: –ù–∞—à —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:

-   –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–ª–∞—Ç–µ–∂–∏
-   –ü—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ—Ñ–∞–Ω–¥—ã
-   –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
-   –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∏ –±–µ–∑ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å—Ç–∞–ª–æ —è—Å–Ω–æ, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ 3 —é–∑–µ—Ä-—Å—Ç–æ—Ä–∏.

h---

### –ü–æ–¥–ø–∏—Å–∫–∞

–Ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –Ø —Ö–æ—á—É:

-   –Ø –∂–º—É "–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
-   –ü–æ–ø–∞–¥–∞—é –Ω–∞ —Ñ–æ—Ä–º—É —Å –≤—ã–±–æ—Ä–æ–º –º–µ—Ç–æ–¥–∞ –æ–ø–ª–∞—Ç—ã
-   –í–≤–æ–∂—É –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
-   –ñ–º—É "–æ–ø–ª–∞—Ç–∏—Ç—å"
-   –í–∏–∂—É —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
-   –ò–¥—É —Å–º–æ—Ç—Ä–µ—Ç—å –∫–∏–Ω–æ üé•
    note: –ø–æ–¥–ø–∏—Å–∫–∞

h---

### –í–æ–∑–≤—Ä–∞—Ç

–Ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –Ø —Ö–æ—á—É:

-   –Ø –∂–º—É –Ω–∞ –∫–Ω–æ–ø–∫—É "–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
-   –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é —Å–≤–æ—ë —Ä–µ—à–µ–Ω–∏–µ
-   –ü–æ–ª—É—á–∞—é –ø–∏—Å—å–º–æ –æ –≤–æ–∑–≤—Ä–∞—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤
    note: –≤–æ–∑–≤—Ä–∞—Ç

h---

### –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–ª–∞—Ç–µ–∂–µ–π

–Ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –Ø —Ö–æ—á—É:

-   –í–∏–¥–µ—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
-   –í–∏–¥–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º: –≤—Ä–µ–º—è —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å—Ä–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏, —Ç–∏–ø –ø–ª–∞—Ç–µ–∂–∞
    note: –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–ª–∞—Ç–µ–∂–µ–π

h---

[comment]: <> (–°–µ—Ä–≤–∏—Å—ã)

### –û—Ç–ª–∏—á–Ω–æ, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –µ—Å—Ç—å. –ê –∫–∞–∫ –¥–µ–ª–∞—Ç—å –±—É–¥–µ–º?

![services](https://avatars.mds.yandex.net/i?id=71c84134dc73feeb9bb47bb24a798052a9361a07-10092505-images-thumbs&n=13)

note: –ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –Ω–∞–¥–æ –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ä–≤–∏—Å–∞.

h---

### –ß—Ç–æ –Ω–∞–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–æ?

![entities](./content/entities.png)

note: –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–ª–æ—Å—å, –∏—Å—Ö–æ–¥—è –∏–∑ —Ç–æ–≥–æ, –∫–∞–∫–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ —É –Ω–∞—Å –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:

-   –ø–ª–∞—Ç–µ–∂
-   –ø–æ–¥–ø–∏—Å–∫–∞
-   –≤–æ–∑–≤—Ä–∞—Ç
-   –∞–∫–∫–∞—É–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
-   –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

h---

### –ö–∞–∂–µ—Ç—Å—è, –æ–¥–Ω–∏–º —Å–µ—Ä–≤–∏—Å–æ–º –¥–µ–ª–æ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—Å—è

![services](./content/services.svg)

note: –ë—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —ç—Ç–∏ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, —Ç.–∫. –¥–æ —ç—Ç–æ–≥–æ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ—è–≤–∏–ª–∏—Å—å –¥–≤–∞ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ billing –∏ subscription.

h---

### –ü—Ä–∏–∫–∏–¥—ã–≤–∞–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ä–≤–∏—Å–æ–≤

![general](./content/general.svg)
note: –ë—ã–ª–æ —Ä–µ—à–µ–Ω–æ, —Ç.–∫. –≤—Ä–µ–º–µ–Ω–∏ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ, —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—Å—è –Ω–∞ –±–∏–ª–ª–∏–Ω–≥–µ, –∞ subscription –¥–µ–ª–∞—Ç—å –ø–æ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É.

–û–ø–∏—Ä–∞—è—Å—å –Ω–∞ –ø—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∞ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤–æ—Ç —Ç–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.
h---

### –ê —á—Ç–æ —Å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º?

![cloudpayments](https://sovmart.ru/images/swjprojects/projects/2/ru-RU/cover.png)
note: –í –∫–∞—á–µ—Å—Ç–≤–µ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ –±—ã–ª –≤—ã–±—Ä–∞–Ω cloudpayments
h---

### –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –∞–≤—Ç–æ–º–∞—Ç—ã

![automate](./content/automate.jpeg)

note: –ï—â—ë –Ω—É–∂–Ω–æ –±—ã–ª–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –±–∏–ª–ª–∏–Ω–≥–∞. –ü–æ —Å–æ–≤–µ—Ç—É —ç–∫—Å–ø–µ—Ä—Ç–∞ –º—ã —Ä–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω–µ—á–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã.
h---

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ transitions

<img src="./content/transitions.png" alt="drawing" width="50%" height="50%">

[pytransitions/transitions](https://github.com/pytransitions/transitions)

note: –í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∑—è–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É transitions. –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –±—É–¥—É—Ç —á—É—Ç—å –¥–∞–ª—å—à–µ.
h---

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

-   psycopg3
-   FastAPI
-   Django
-   pytransitions/transitions
-   sqlalchemy2
-   pydantic
-   orjson

note: –ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω—É–∂–Ω—ã.

h---

### –î–∞–Ω–Ω—ã–µ

![data](https://avatars.mds.yandex.net/i?id=0ff0a7a78a4c6c7c209b89295a0ea563_l-4304125-images-thumbs&n=13)
note: –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –∫–æ–¥–∞.
–ù–∞—á–∞–ª–∏ –º—ã —Å –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö.
h---

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö: –±–∏–ª–ª–∏–Ω–≥

![payments-schema](./content/payments_schema.drawio.svg)

note: –ü—Ä–∏–≤–µ—Ç, —è - –°–µ—Ä–≥–µ–π.
–Ø —Ö–æ—á—É —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –±–∏–ª–ª–∏–Ω–≥–∞.

–£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ —Å—É—â–Ω–æ—Å—Ç–∏: Invoice, Refund, Acquiring_log

–í Invoice —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–ª–∞—Ç–µ–∂–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ subscription-api.
–î–ª—è —Å–≤—è–∑–∏ —Å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç—ã transaction_id, invoice_id –∏ acq_provider.
–°–æ—á–µ—Ç–∞–Ω–∏–µ acq_provider –∏ transcation_id —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –ø–ª–∞—Ç–µ–∂–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞.
–í –ø–æ–ª–µ info –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç–∫–≤–∞–π—Ä–∏–Ω–≥–µ –∏ –ø–ª–∞—Ç–µ–∂–µ.

–í Refund –≤–µ–¥—É—Ç—Å—è –≤–æ–∑–≤—Ä–∞—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π.
–í–æ–∑–≤—Ä–∞—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–ª–∞—Ç–µ–∂–∞, –ø–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å –µ—Å—Ç—å FK –¥–ª—è invoice_id.
–î–ª—è —Å–≤—è–∑–∏ —Å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç—ã invoice_id, transaction_id –∏ acq_provider.

–¢–∞–±–ª–∏—Ü–∞ acquiring_log –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –≤ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–µ.
–¢–∞–º –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ª—é–±—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ–ª—É—á–∞–µ–º—ã–µ –æ—Ç —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞:
–Ω–æ–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –æ–Ω –Ω–∞–º –≤–µ—Ä–Ω—É–ª –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ.
–≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–¥–∞—é—Ç –µ—â—ë –≤ –∏ ELK —Å—Ç–µ–∫, —Ç–∞–±–ª–∏—Ü–∞ –Ω—É–∂–Ω–∞ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

h---

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö: –ø–æ–¥–ø–∏—Å–∫–∏

![sub-schema](./content/sub_schema.drawio.svg)

h---

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ?

<img src="./content/payments_1.png" alt="drawing" width="70%" height="70%"/>
note: –ü—Ä–∏–≤–µ—Ç, —è - –í–∏–∫—Ç–æ—Ä. –Ø —Ä–∞—Å—Å–∫–∞–∂—É –æ —Ç–æ–º, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–ø–ª–∞—Ç—ã —É—Å–ª—É–≥ –≤ –Ω–∞—à–µ–º –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–µ.

–í—ã–±–∏—Ä–∞—è —ç–∫–≤–∞–π—Ä–∏–Ω–≥. –º—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ CloudPayments, —Ç.–∫. —É–∂–µ –±—ã–ª –∑–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç + —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç–∫–≤–∞–π—Ä–∏–Ω–≥ —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Ñ—É–Ω–∫—Ü–∏–π.

Cloudpayments –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–≤–æ–π SDK, –≤–∏–¥–∂–µ—Ç—ã –∏ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤–µ–±—Ö—É–∫–æ–≤..

–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é —ç—Ç–æ–≥–æ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤–∏–¥–∂–µ—Ç–∞, —Ç.–µ. –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å–∞–π—Ç —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞.
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã —Ñ–æ—Ä–º–∏—Ä—É–µ–º —É —Å–µ–±—è –ø–ª–∞—Ç–µ–∂, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–µ—Ä–µ–¥–∞–µ–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç –¥–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∞.
–ö–ª–∏–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∏–¥–∂–µ—Ç, –ø–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º, –¥–ª—è –æ–ø–ª–∞—Ç—ã.

h---

### –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã —Ö—É–∫–æ–≤ –ø–ª–∞—Ç–µ–∂–∞

  <div style="display: flex; flex-direction: row;">
    <img src="./content/payments_2.png" alt="drawing" width="50%" height="50%"/>
    <img src="./content/payments_3.png" alt="drawing" width="50%" height="50%"/>
  </div>

note: –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤–∏–¥–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç —ç–∫–≤–∞–π—Ä–∏–Ω–≥—É –¥–∞–Ω–Ω—ã–µ –æ –ø–ª–∞—Ç–µ–∂–µ, —ç–∫–≤–∞–π—Ä–∏–Ω–≥ –æ–±—Ä–∞—Ç–∏—Ç—Å—è –∫ –Ω–∞—à–µ–º—É –±—ç–∫–µ–Ω–¥—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–∞.
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —ç–∫–≤–∞–π—Ä–∏–Ω–≥ —Å–ø–∏—à–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏ –µ—â–µ —Ä–∞–∑ –≤—ã–∑–æ–≤–µ—Ç –Ω–∞—à —Å–µ—Ä–≤–µ—Ä, —á—Ç–æ–±—ã —Å–æ–æ–±—â–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞.
–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞, –∏–ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ –¥–µ—Ä–≥–∞–µ—Ç—Å—è –≤–µ–±—Ö—É–∫ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–¥–ø–∏—Å–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∞.

h---

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ

<img src="./content/refunds_v2.drawio.svg" alt="drawing" width="78%" height="75%"/>

note: –Ø —Ä–µ—à–∏–ª –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤–µ–±—Ö—É–∫ –æ—Ç —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ –∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –æ—Ç –Ω–∞—à–µ–≥–æ subscriptions-api –≤ –æ–¥–Ω—É —Å—Ö–µ–º—É.

–°–Ω–∞—á–∞–ª–∞ —É—Å–ø–µ—à–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
–û—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç –≤ subscriptions-api, –∑–∞—Ç–µ–º –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –≤ –±–∏–ª–ª–∏–Ω–≥.
–ë–∏–ª–ª–∏–Ω–≥ –Ω–∞—Ö–æ–¥–∏—Ç –ø–ª–∞—Ç–µ–∂ –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Ö–æ—Ç—è—Ç —Å–¥–µ–ª–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç –∏ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É Refund. –ù–∞ —ç—Ç–æ–º –∂–µ —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —É–∂–µ –≤–æ–∑–≤—Ä–∞—Ç –ø–æ —ç—Ç–æ–º—É –ø–ª–∞—Ç–µ–∂—É.
–ï—Å–ª–∏ –≤—Å–µ —Ö–æ—Ä–æ—à–æ, —Å–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç–µ–∂ –≤ —Å—Ç–∞—Ç—É—Å–µ pending –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —ç–∫–≤–∞–π–µ—Ä—É.
–ï—Å–ª–∏ —ç–∫–≤–∞–π–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª —á–µ–º-—Ç–æ –∫—Ä–æ–º–µ 200, —Ñ–µ–π–ª–∏–º –ø–ª–∞—Ç–µ–∂ (–º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ —Ñ–µ–π–ª–¥) –∏ –∑–∞–Ω–æ—Å–∏–º –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ acquiring_log.

h---

### –ü—Ä–æ—Ü–µ—Å—Å –±–∏–ª–ª–∏–Ω–≥–∞

```python3
class BillingProcessABC(asyncio.AsyncMachine, mixins.TableMixin, abc.ABC):
    def __init__(
        self, *args, aquiring_provider: protocols.AcquiringProviderProtocol, **kwargs
    ):
        self._transaction_id: str | None = None
        self._status: str | None = None
        self._session: asql.AsyncSession | None = None
        self._locked_entry: db.Invoice | db.Refund | None = None
        self._entry_id: uuid.UUID | None = None
        self._acquiring_provider: protocols.AcquiringProviderProtocol = (
            aquiring_provider
        )
        super().__init__(*args, **kwargs)

    async def _before_change(self, event: transitions.EventData):
        if not self.table is None or (
            self._entry_id is None and self._transaction_id is None
        ):
            return

        self._session = db_session.get()
        if self._entry_id:
            result = await self._session.execute(
                sql.Select(self.table)
                .where(self.table.id == self._entry_id)
                .with_for_update()  # TODO : explore timeout possibilites
            )
            self._locked_entry = typing.cast(
                db.Invoice | db.Refund | None, result.one_or_none()
            )
            return

        result = await self._session.execute(
            sql.Select(self.table)
            .where(
                sql.and_(
                    self.table.aquiring_provider == self._acquiring_provider.title,
                    self.table.transaction_id == self._transaction_id,
                )
            )
            .with_for_update()
        )
        self._locked_entry = result.one_or_none()  # type: ignore

    async def get_pid(self) -> uuid.UUID:
        if self._entry_id is None:
            raise exc.NotFoundError
        return self._entry_id

    async def _after_change(self, event: transitions.EventData):
        if (
            self._entry_id is None
            or self._session is None
            or self._locked_entry is None
        ):
            return
        await self._session.commit()
        self._session = None
        self._locked_entry = None

    async def _store(self, event: transitions.EventData):
        if self._entry_id is None or self._locked_entry is None:
            raise exc.LogicError
        self._locked_entry.process = pickle.dumps(self)
        statement = sql.update(self.table).where(self.table.id == self._entry_id)
        await self._session.execute(statement, (self._locked_entry,))  # type: ignore

    @abc.abstractmethod
    async def on_exception(self, event: transitions.EventData):
        ...
```

note: –ù–∞–∫–æ–Ω–µ—Ü, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–∏–Ω–∞–ª—É –∏—Å—Ç–æ—Ä–∏–∏, —á—Ç–æ –∂–µ –≤ –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å.
–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –ø—Ä–æ—Ü–µ—Å—Å –±–∏–ª–ª–∏–Ω–≥–∞, —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º –æ–±—ä–µ–∫—Ç –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ.
–í –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–±–æ—Ä–æ—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –±–¥, —Å –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ–º. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–∏–±–æ –ø–æ ID, –ª–∏–±–æ –ø–æ ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ –∏ —Å–∞–º–æ–º—É —ç–∫–≤–∞–π—Ä–∏–Ω–≥—É.

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –º—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏ —Ä–∞–±–æ—Ç—É —Å —Ç–∞–±–ª–∏—Ü–µ–π, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ—Ç–ø—É—Å–∫–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å –ø–æ–º–æ—â—å—é –∫–æ–º–º–∏—Ç–∞.
h---

### –ü—Ä–æ—Ü–µ—Å—Å –ø–ª–∞—Ç–µ–∂–∞

```python
class InvoiceProcessABC(BillingProcessABC, mixins.InvoiceTableMixin, abc.ABC):
    def __init__(self, *args, **kwargs):
        states = enums.InvoiceStates
        self._locked_entry: db.Invoice | None = None
        self.table = self.__class__.table
        super().__init__(
            self,
            *args,
            states=states,
            initial=enums.InvoiceStates.NONE,
            send_event=True,
            before_state_change=self._before_change,
            after_state_change=self._after_change,
            **kwargs,
        )
        self.add_transition('store', list(enums.InvoiceStates), '=', after=self._store)
        self.add_transition(
            'create',
            enums.InvoiceStates.NONE,
            enums.InvoiceStates.CREATED,
            before=self._before_create,
            after=self._after_create,
        )
        self.add_transition(
            'check',
            enums.InvoiceStates.CREATED,
            enums.InvoiceStates.PENDING,
            before=self._before_check,
            after=self._after_check,
            conditions=self._is_locked,
        )
        self.add_transition(
            'pay',
            enums.InvoiceStates.PENDING,
            enums.InvoiceStates.PAID,
            before=self._before_pay,
            after=self._after_pay,
            conditions=self._is_locked,
        )
        self.add_transition(
            'cancel',
            [enums.InvoiceStates.CREATED, enums.InvoiceStates.PAID],
            enums.InvoiceStates.CANCELED,
            before=self._before_cancel,
            after=self._after_cancel,
            conditions=self._is_locked,
        )
        self.add_transition(
            'fail',
            [enums.InvoiceStates.CREATED, enums.InvoiceStates.PAID],
            enums.InvoiceStates.FAILED,
            before=self._before_fail,
            after=self._after_fail,
            conditions=self._is_locked,
        )

    def _is_locked(self) -> bool:
        return bool(self._locked_entry)

```

note: –í –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–ª–∞—Ç–µ–∂–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–∞—à–∏–Ω—ã. –ú—ã –ø–µ—Ä–µ–¥–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –ª–∏–±–æ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–æ–∫, –ª–∏–±–æ –≤ –≤–∏–¥–µ enuma, –∑–∞—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—à–∏–Ω—ã –º—ã –º–æ–∂–µ–º –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –∫ –Ω–µ–π transition –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç–µ–π—Ç–∞–º–∏.

h---

### –ü—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–≤—Ä–∞—Ç–∞

```python
class RefundProcessABC(mixins.RefundTableMixin, BillingProcessABC, abc.ABC):
    table = db.Refund

    def __init__(self, *args, **kwargs):
        states = enums.RefundStates
        self._locked_entry: db.Refund | None = None
        super().__init__(
            self,
            *args,
            states=states,
            initial=enums.RefundStates.NONE,
            send_event=True,
            before_state_change=self._before_change,
            after_state_change=self._after_change,
            **kwargs,
        )
        self.add_transition('store', list(enums.InvoiceStates), '=', after=self._store)
        self.add_transition(
            'create',
            enums.RefundStates.NONE,
            enums.RefundStates.CREATED,
            before=self._before_create,
            after=self._after_create,
        )
        self.add_transition(
            'register',
            enums.RefundStates.CREATED,
            enums.RefundStates.PENDING,
            before=self._before_register,
            after=self._after_register,
            conditions=[self._is_locked],
        )
        self.add_transition(
            'refunded',
            enums.RefundStates.PENDING,
            enums.RefundStates.REFUNDED,
            prepare=self._lock,
            before=self._before_refund,
            after=self._after_refund,
            conditions=self._is_locked,
        )
        self.add_transition(
            'fail',
            [enums.RefundStates.CREATED, enums.RefundStates.PENDING],
            enums.RefundStates.FAILED,
            prepare=self._lock,
            before=self._before_fail,
            after=self._after_fail,
            conditions=self._is_locked,
        )

    async def _find_acquirer(self, event: transitions.EventData):
        ...

    def _is_locked(self, *args, **kwargs) -> bool:
        return bool(self._locked_entry)
```

note: –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ—Ñ–∞–Ω–¥–∞ –≤—ã–≥–ª—è–¥–∏—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–ª–∞—Ç–µ–∂—É.

h---

[comment]: <> (–î–µ–º–æ)

### –ê —Ç–µ–ø–µ—Ä—å —Å–º–æ—Ç—Ä–∏–º!

[–î–µ–º–∫–∞ –±–∏–ª–ª–∏–Ω–≥–∞]()

h---

### –ß—Ç–æ –Ω–µ —É—Å–ø–µ–ª–∏?

-   —Å–µ—Ä–≤–∏—Å –ø–æ–¥–ø–∏—Å–æ–∫ (–≥–æ—Ç–æ–≤ —Ç–æ–ª—å–∫–æ barebone –∏ –ø–∞—Ä–∞ —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤)
    note: –ù–µ —É—Å–ø–µ–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–æ–¥–ø–∏—Å–æ–∫, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–º —Å–≤–æ—è –±–æ–ª—å—à–∞—è –ª–æ–≥–∏–∫–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–∏—Å–æ–º –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã –ª–∏—à—å —á–∞—Å—Ç–∏—á–Ω–æ.

h---

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å?

-   —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
-   Event-driven –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

note: –ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏—á–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∏ —à–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –º–æ–¥–µ–ª–∏, –∫–∞–∫ –≤ —Å–µ—Ä–≤–∏—Å–µ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π.

h---

### –í–æ–ø—Ä–æ—Å—ã?
